# 일시 중단 함수

- 일시중단 함수란?
    - 함수 내에 원하는 지점에서 일시 중단 지점을 포함할 수 있는 함수
    - 원하는 지점에서 모든 필요한 런타임 문맥을 저장하고 실행을 중단한 뒤,  이후 다시 실행을 계속할 수 있다.


- 코루틴과 일시중단 함수의 관계
    - 코루틴 : 비동기 작업을 처리하기 위한 실행환경
    - 일시중단 함수 : 코루틴 안에서 실행되는, 일시중단 기능을 가진 함수
    - 코루틴의 주요 목적인 비동기 작업을 처리하기 위해서 일시 중단 함수를 통해 구현하는 것이다.


- 대표적인 일시중단 함수인 `delay()`

  ![image](https://github.com/user-attachments/assets/ef0b3f19-edb7-4a00-9d21-78bbcff5a1eb)

    - 자바의 Thread.sleep()과 비슷한 역할을 한다.
    - 하지만 일시중단 함수이기 때문에 현재 스레드를 블락하는 것이 아니라, 일시 중단 시킨다.
    - 따라서 해당 스레드는 다른 작업을 수행할 수 있다.


- 호출 방향

    ```mermaid
    stateDiagram-v2
        일시중단함수 --> 일시중단함수A : 가능
        일시중단함수 --> 일반함수A : 가능
        일반함수 --> 일시중단함수B : 불가능!
    ```

    - 일시중단 함수는 일시중단 함수 / 일반 함수 모두 원하는 대로 호출할 수 있다.
        - 일시중단 함수를 호출하는 경우
            - 호출 지점이 일시 중단 지점이 된다.
            - 따라서 스레드가 Block 되지 않고 비동기 실행된다.
        - 일반 함수를 호출하는 경우
            - 다른 일반 함수와 동일하게, 일반 함수 실행이 모두 끝난 뒤 제어가 돌아온다. ( 일시 중단 X )
            - 따라서 동일한 스레드에서 동기적으로 동작하는 것이다.
    - 일반함수는 일시중단 함수를 호출할 수 없다.
        - Why?
            - 일반 함수는 호출 스택을 사용하여 작업을 순차적으로 처리한다.
            - 일시중단 함수는 코루틴 컨텍스트 내에서 실행된다.
            - 따라서 일반 함수는 코루틴 컨텍스트가 설정되어있지 않기 때문에, 일시중단 함수를 실행시킬 수 없는 것이다.
        - 일반 함수에서 일시 중단 함수를 호출하려면 runBlocking이나 코루틴 빌더를 사용해야한다.


- 사용하는 법
    - suspend 키워드를 통해 일시중단 함수를 선언할 수 있다.

        ```kotlin
        suspend fun test(){
        	println("일시중단함수")
        }
        ```