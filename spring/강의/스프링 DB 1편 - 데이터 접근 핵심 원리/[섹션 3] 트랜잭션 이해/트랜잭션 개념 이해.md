### 트랜잭션 개념 이해

- 트랜잭션이란?
    - 하나의 거래를 안전하게 처리하도록 보장해주는 것
    - Commit : 모든 작업이 성공하여 데이터베이스에 정상 반영
    - Rollback : 작업 중 하나라도 실채하여 거래 이전으로 되돌림


- ACID
    - 원자성 ( Atomicity )
        - 트랜잭션 내의 작업은 마치 하나인 것 처럼 **모두 성공**하거나, **모두 실패**해야한다.
    - 일관성 ( Consistency )
        - 일관성 있는 데이터베이스 상태를 유지해야한다.
        - ex) 데이터베이스의 무결정 제약 조건
            - null이 들어가지 않거나, 특정 값만 들어가는 등
    - 격리성 ( Isolation )
        - 동시에 실행되는 트랜잭션이 서로에게 영향을 미치지 않아야 한다.
        - 성능이슈로 인해 격리수준을 선택할 수 있다.
            - READ_UNCOMMITED, READ_COMMITED, REPEATABLE_READ, SERIALIZABLE
    - 지속성 ( Durability )
        - 트랜잭션을 성공적으로 끝내면 그 결과가 기록되어야 한다.


- 세션

  ![image](https://github.com/ulimy/study/assets/18046394/648b9095-83f3-4df6-aa47-d382ed1bbdda)

    - 커넥션

      > 클라이언트와 데이터베이스 서버에 연결을 맺기 위해 활용

    - 세션

      > 클라이언트로부터 받은 요청 실행
      >
        - sql 실행, 트랜잭션 시작, 커밋, 롤백 등등
        - 세션은 트랜잭션과 함께 시작, 종료된다.
        - 하나의 커넥션 당 하나의 세션이 매핑된다.


- 트랜잭션을 시작한다 == 수동커밋 모드로 실행한다.
    - 수동커밋모드란?
        - 커밋, 롤백을 자동으로 해주는 것이 아니라 직접 선언해야하는 모드
        - 커밋, 롤백을 명시적으로 하지 않는다면? 데이터베이스에서 Timeout을 통해 롤백시킨다.
    - 수동으로 트랜잭션을 시작하는 것이 커밋, 롤백을 명시적으로 해주는 것을 의미 하므로, 수동커밋모드와 동일한 의미를 가진다.


- 하나의 트랜잭션에서는 같은 커넥션을 이용해야한다.
    - 같은 커넥션을 활용해야 커밋, 롤백 등이 하나의 단위로, 정상적으로 수행될 수 있다.
    - 가장 간단한 방법은 커넥션을 파라미터로 넘겨 같은 작업에서 같은 커넥션이 활용될 수 있도록 하는 것!
    - 스프링은 @Transactional을 통해 하나의 트랜잭션에서 같은 커넥션을 활용할 수 있도록 도와준다!

      ⇒ 커넥션 획득, 커밋, 종료 등등을 도와줌.
