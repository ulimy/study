### [4장] 불변 활용하기 : 안정적으로 동작하게 만들기

- 재할당

  > 변수에 값을 다시 할당하는 것. ( == 파괴적 할당 )
  >
    - 변수에 다른 값을 계속 재할당 하면, 해당 변수가 어떤 의미를 가지고 있는지 파악하기 어려워진다.
    - 해결방안 :  불변변수로 만들기 ( final )


- 가변으로 인한 부작용 사례
    - 가변 인스턴스의 재사용
        - 인스턴스 A를 B, C에서 모두 재사용

          ⇒ A가 바뀌면 B, C 모두에 영향을 끼친다.

        - B, C에서 사용할 인스턴스를 개별적으로 생성하여 재사용하지 못하도록 막기.
    - 함수를 통한 가변 인스턴스 조작
        - 같은 인스턴스를 다른 스레드에서 함수를 통해 조작

          ⇒ 해당 인스턴스를 원래 사용하고 있던 곳에 영향을 끼친다.


- 함수의 영향범위 한정하기
    - 예상치 못한 부작용을 막으려면 해당 함수가 영향을 줄 수 있는 범위를 한정해야한다.
        - 객체지향에서는 클래스 내부까지 한정하는 것이 일반적이다.
    - 매개변수로 상태를 받고, 상태를 변경하지 않고, 값을 리턴만 하기.


- 불변으로 만들어서 부작용 막기


- 가변으로 설계해야하는 경우
    - 성능이 중요한 경우
        - 값이 변경되어 새로운 인스턴스를 생성함으로써 성능에 문제 발생 가능
    - 영향범위가 매우 국소적인 경우
        - ex) 반복문 counter


- 상태를 변경시키는 메서드 ( == 뮤테이터 )
    - 요구사항에 맞게 변경되도록 항상 주의하기.


- 코드 외부와의 데이터 교환에 주의하기

  > ex. 파일 I/O, 데이터베이스
  >
    - 코드 외부는 동작 예측이 어려워 문제가 발생할 수 있다.
    - 레포지터리 패턴
        - 데이터베이스의 영속화를 캡슐화하는 디자인 패턴
